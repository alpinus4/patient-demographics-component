<link rel="import" href="bower_components/polymer/polymer-element.html">
<link rel="import" href="https://polygit.org/polymer+v2.0.0/shadycss+webcomponents+1.0.0/components/iron-ajax/iron-ajax.html">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

<dom-module id="patient-demographics">

  <template>

    <style>
      /* shadow DOM styles go here */
      :host {
        display: inline-block;
      }

      :host #patient_demographics{
        width: 100%;
        font-size: var(--patient-demographics-font-size , 25pt);
        color: var(--patient-demographics-font-color , rgb(24, 24, 24));
        background: var(--patient-demographics-label-background , rgb(255, 255, 255));
        padding: 20px;
        font-family: 'Roboto', sans-serif;

      }

      :host #name{
        width: 91%;
        font-size: var(--patient-demographics-font-size-name , 40pt);
        text-decoration: underline;
        text-decoration-color: var(--patient-demographics-underline-color, rgb(0, 0, 0));
      }

      :host #patientID{
        width: 100%;
        font-size: var(--patient-demographics-font-size-id , 20pt);
        color: var(--patient-demographics-font-color-id , rgb(88, 88, 88));
      }

      :host #address, #phone{
        width: auto;
        font-size: var(--patient-demographics-font-size-address , 20pt);
        color: var(--patient-demographics-font-color-address , rgb(38, 38, 38));
      }

    </style>


    <!-- shadow DOM goes here -->
  <div id="patient_demographics">
        <span id="patientID">Patient ID: {{patientid}}</span>
    <div id="name">{{firstName}}&nbsp;{{middleName}}&nbsp;{{lastName}}</div>
    {{age}} year(s) old &nbsp;(<span id="birthdate">{{dateOfBirth}}</span>)&nbsp; <span id="gender">{{gender}}</span> &nbsp; <span id="dead">{{deadInformation}}</span></br></br>
    <div id="address"><b>Address:</b>  {{address}}, {{cityVillage}},  {{stateProvince}},  {{country}}</div>
  </div>
  </template>

  <script>
    class PatientDemographics extends Polymer.Element {
      static get is() {
          return 'patient-demographics';
      }
      static get properties() {
        return {
          firstName: {
            type: String
          },
          middleName: {
            type: String
          },
          lastName: {
            type: String
          },
          age: {
            type: String
          },
          dateOfBirth: {
            type: String,
            observer:'_correctDate'
          },
          gender: {
            type: String,
            observer:'_correctGender'
          },
          patientid: {
            type: String
          },
          address: {
            type: String
          },
          cityVillage: {
            type:String
          },
          stateProvince: {
            type: String
          },
          country: {
            type: String
          },
          telephoneNumber: {
            type: String
          },
          dead: {
            type: Boolean,
            observer:'_correctDead'
          },
          deadInformation: {
            type: String
          },
          genderObserverCount:{
            type:Number
          },
          dateOfBirthObserverCount:{
            type:Number
          },
          deadObserverCount:{
            type:Number
          }
        }
      }
      constructor() {
        super();
        this.genderObserverCount = 0;
        this.dateOfBirthObserverCount = 0;
        this.deadObserverCount = 0;
      }

      _correctDate(){
        if(this.dateOfBirthObserverCount < 1){
          this.dateOfBirthObserverCount++;

          var date = new Date(this.dateOfBirth);

          //part of code from https://stackoverflow.com/questions/3605214/javascript-add-leading-zeroes-to-date
          var myDateString;
          date.setDate(date.getDate()+0);
          myDateString = ('0' + date.getDate()).slice(-2) + '/'
               + ('0' + (date.getMonth()+1)).slice(-2) + '/'
               + date.getFullYear();

          this.dateOfBirth = myDateString;
        }
      }


      _correctGender(){
        if(this.genderObserverCount < 1){
          this.genderObserverCount++;
          if(this.gender == "M"){
            this.gender = "Male";
          }

          if(this.gender == "F"){
            this.gender = "Female";
          }
        }
      }

      _correctDead(){
        if(this.deadObserverCount < 1){
          this.deadObserverCount++;

          if(this.dead == false){
            this.deadInformation = "Alive"
          }else{
            this.deadInformation = "Dead"
          }
        }
      }

    }
    customElements.define(PatientDemographics.is, PatientDemographics);
  </script>

</dom-module>
